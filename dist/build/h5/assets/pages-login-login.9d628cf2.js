import{a as e,u as l,r as t,J as a,K as s,g as o,L as n,s as r,o as u,b as i,c,d,e as p,w as g,i as v,f as h,l as _,t as f,k as m,m as x,n as y,M as w,h as b,j as C,F as k,T as S,q as j,N as L,v as V,P as $,Q as B}from"./index.61b5b460.js";import{_ as E}from"./loading.d21df86d.js";import{_ as I,o as T,r as U,a as R}from"./request.ef5cbed2.js";import{_ as q}from"./lang.08833616.js";import{_ as z,a as F}from"./pwd.d3378111.js";import{_ as N,a as P}from"./eyeClose.26c6c18a.js";var D=I({__name:"login",setup(I){const{t:D}=e(),J=l(),K=t(!0),M=t([]),Q=t({phone:"",password:""}),A=t(!1),G=t(0),H=t(!1),O=t(""),W=t(!1),X=t(null),Y={background:J.$state.contentColor,color:"#fff",boxShadow:"0rpx 11rpx 47rpx 4rpx rgba(247, 175, 64, 0.35)"};J.$state.btnDis;const Z=t(!1);a(Q,((e,l)=>{let t=O.value.preg.replace("/","").replace("/",""),a=new RegExp(t);a.test(Q.value.phone)?H.value=!0:(A.value=!1,H.value=!1),a.test(Q.value.phone)&&Q.value.password.length>5&&Q.value.password.length<25?A.value=!0:(A.value=!1,A.value=!1)}),{deep:!0});const ee=t([]),le=t(""),te=e=>{if(!M.value)return!1;let l=[];M.value.forEach((e=>{if(!e.alias.toLowerCase().includes(le.value.toLowerCase())&&!e.country_code.toLowerCase().includes(le.value.toLowerCase()))return!1;l.push(e)})),ee.value=l},ae=s((()=>{try{return`/static/guojia/${O.value.country_code.replace("+","")}.png`}catch(e){}})),se=()=>{let e=O.value.preg.replace("/","").replace("/","");return new RegExp(e).test(Q.value.phone)?Q.value.password.length<6||Q.value.password.length>24?(S.text(D("login.l_l4")),!1):(X.value.loading=!0,void setTimeout((()=>{oe()}),1500)):(S.text(D("login.l_l3")),!1)},oe=()=>{Q.value.country_code=O.value.text,U({url:"/join/login",methods:"post",data:Q.value}).then((e=>{X.value.loading=!1,S.text(D("login.l_l5")),r("token",e.accessToken),setTimeout((()=>{j({url:"../tabbar/index"})}),1e3)})).catch((e=>{X.value.loading=!1,L({title:e.message,icon:"none"})}))},ne=()=>{Z.value=!0,W.value=!0},re=e=>{j({url:e})},ue=()=>{history.back()};return T((()=>{let e=o("lang");n(),G.value=0,e?(r("lang",e),r("setLang",!0)):U({url:"setting/lang",methods:"get"}).then((e=>{r("lang",e[0].lang),r("setLang",!0),history.go(0)})),U({url:"/setting/country",methods:"get"}).then((e=>{let l=[];for(let t=0;t<e.length;t++)e[t].text=e[t].country_code,e[t].value=e[t].id,l.push(e[t]);ee.value=l,J.setCountryCode(l),O.value=J.$state.countryCode[0],M.value=J.$state.countryCode,X.value.loading=!1}))})),u((()=>{X.value.loading=!0})),(e,l)=>{const t=V,a=v,s=$,o=B,n=i("nut-icon"),r=i("nut-popup"),u=R(c("Loading"),E);return d(),p(a,{class:"pdlr30 l_bg"},{default:g((()=>[h(a,{class:"pt30 between"},{default:g((()=>[h(t,{src:"/static/themeNum1/l_icon/l_back.png",mode:"widthFix",style:{width:"70rpx",height:"70rpx"},onClick:ue}),h(t,{src:q,style:{width:"57rpx",height:"56rpx"},onClick:l[0]||(l[0]=e=>re("../mine/langSetting"))})])),_:1}),h(a,{class:"pdlr40"},{default:g((()=>[h(a,{class:"mt85 text_white f60 text_bold"},{default:g((()=>[_(f(m(D)("login.l_b1")),1)])),_:1}),h(a,{style:{"margin-top":"167rpx"}},{default:g((()=>[h(a,{class:"flex between l_inpS"},{default:g((()=>[h(a,{class:"l_inpBg between l_inpS pdlr20",style:{width:"360rpx"},onClick:l[1]||(l[1]=e=>W.value=!0)},{default:g((()=>[h(a,{class:"between row_center",style:{width:"70%"}},{default:g((()=>[h(a,{class:"center"},{default:g((()=>[h(t,{src:m(ae),style:{width:"43rpx",height:"29rpx"}},null,8,["src"])])),_:1}),h(s,{class:"f22"},{default:g((()=>[_(f(O.value.country_code),1)])),_:1})])),_:1}),h(a,null,{default:g((()=>[h(t,{src:z,style:{width:"30rpx",height:"18rpx"}})])),_:1})])),_:1}),h(a,{class:"ml20 l_inpS l_inpBg flex col_center pdlr50",style:{width:"100%"}},{default:g((()=>[h(o,{type:"text",placeholder:m(D)("login.l_l1"),style:{color:"#333"},modelValue:Q.value.phone,"onUpdate:modelValue":l[2]||(l[2]=e=>Q.value.phone=e)},null,8,["placeholder","modelValue"]),H.value?(d(),p(n,{key:0,name:"Check",size:"20",class:"phoneCheck animate__animated animate__fadeIn",color:"green"})):x("",!0)])),_:1})])),_:1}),h(a,{class:"flex between l_inpS mt40 l_inpBg pdlr30"},{default:g((()=>[h(a,null,{default:g((()=>[h(t,{src:F,style:{width:"40rpx",height:"40rpx"}})])),_:1}),h(a,{class:"l_inpS flex col_center",style:{width:"100%"}},{default:g((()=>[h(o,{class:"ml39",type:K.value?"password":"text",placeholder:m(D)("login.l_l2"),style:{color:"#333"},modelValue:Q.value.password,"onUpdate:modelValue":l[3]||(l[3]=e=>Q.value.password=e)},null,8,["type","placeholder","modelValue"])])),_:1}),K.value?x("",!0):(d(),p(t,{key:0,src:N,style:{width:"40rpx",height:"40rpx"},onClick:l[4]||(l[4]=e=>K.value=!K.value)})),K.value?(d(),p(t,{key:1,src:P,style:{width:"40rpx",height:"40rpx"},onClick:l[5]||(l[5]=e=>K.value=!K.value)})):x("",!0)])),_:1}),h(a,{class:"mt30 f24 flex",style:y([{color:m(J).$state.contentColor},{"flex-direction":"row-reverse"}])},{default:g((()=>[h(a,{onClick:ne},{default:g((()=>[_(f(m(D)("login.l_l6")),1)])),_:1})])),_:1},8,["style"]),h(a,{class:"center l_inpS mt40 l_inpBg pdlr30 text_white f32",style:y([{"margin-top":"214rpx"},{background:m(J).$state.contentColor}]),onClick:se},{default:g((()=>[_(f(m(D)("login.l_b1")),1)])),_:1},8,["style"]),h(a,{class:"center l_inpS mt40 l_inpBg pdlr30 text_white mt40 f32",style:y({color:m(J).$state.contentColor})},{default:g((()=>[h(a,{onClick:l[6]||(l[6]=e=>re("./register")),style:{height:"100%",width:"100%"},class:"center"},{default:g((()=>[_(f(m(D)("login.l_b2")),1)])),_:1})])),_:1},8,["style"])])),_:1})])),_:1}),h(r,{position:"left",style:{width:"40%",height:"100%"},visible:W.value,"onUpdate:visible":l[8]||(l[8]=e=>W.value=e)},{default:g((()=>[h(a,{class:"inpSearch"},{default:g((()=>[h(o,{type:"text",modelValue:le.value,"onUpdate:modelValue":l[7]||(l[7]=e=>le.value=e),onClick:w(te,["stop"]),onInput:te,style:{}},null,8,["modelValue","onClick"]),h(n,{name:"search",style:{"margin-right":"40rpx"},size:"20",color:"rgb(22, 183, 57)"})])),_:1}),(d(!0),b(k,null,C(ee.value,((e,l)=>(d(),p(a,{class:"listItem2",style:y(l==G.value?Y:""),onClick:t=>((e,l)=>{if(Z.value){if(1==e.sms_status){let l=e.code.replace("+","");j({url:"./resetPwd?code="+l})}else j({url:"../mine/service"});return W.value=!1,!1}O.value=e,G.value=l,W.value=!1;let t=O.value.preg.replace("/","").replace("/","");new RegExp(t).test(Q.value.phone)?H.value=!0:(A.value=!1,H.value=!1)})(e,l)},{default:g((()=>[_(f(e.text)+" "+f(e.name),1)])),_:2},1032,["style","onClick"])))),256))])),_:1},8,["visible"]),h(u,{ref_key:"showLoading",ref:X},null,512)])),_:1})}}},[["__scopeId","data-v-535f9ed1"]]);export{D as default};
